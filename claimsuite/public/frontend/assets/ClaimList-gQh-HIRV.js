var y=(l,t,o)=>new Promise((v,e)=>{var m=r=>{try{n(o.next(r))}catch(c){e(c)}},b=r=>{try{n(o.throw(r))}catch(c){e(c)}},n=r=>r.done?v(r.value):Promise.resolve(r.value).then(m,b);n((o=o.apply(l,t)).next())});import{C as M}from"./ClaimCard-_ZE4y3vA.js";import{E as T}from"./EmptyState-CZJ1E7jX.js";import{_ as E,a as I,r as h,o as s,c as i,b as d,F as f,g as p,ab as N,d as _,t as x,e as g,h as S,i as C,w as k,f as w,j as R}from"./index-D6a7yGmK.js";const u=20,F={name:"ClaimList",components:{ClaimCard:M,EmptyState:T,FeatherIcon:I},setup(){return{claimsResource:R({url:"claimsuite.api.get_claims"})}},data(){return{PAGE_SIZE:u,activeTab:"all",claims:[],start:0,hasMore:!1,loadingMore:!1,observer:null,tabs:[{label:"All",value:"all"},{label:"Draft",value:"draft"},{label:"Submitted",value:"submitted"},{label:"Cancelled",value:"cancelled"}]}},computed:{emptyTitle(){return this.activeTab==="all"?"No claims yet":`No ${this.activeTab} claims`},emptyMessage(){return this.activeTab==="all"?"Create your first expense claim to get started":`You don't have any ${this.activeTab} claims`}},watch:{activeTab(){this.claims=[],this.start=0,this.hasMore=!1,this.fetchClaims()}},mounted(){this.fetchClaims(),this.setupObserver()},beforeUnmount(){this.observer&&this.observer.disconnect()},methods:{setupObserver(){this.observer=new IntersectionObserver(l=>{l[0].isIntersecting&&this.hasMore&&!this.loadingMore&&this.loadMore()},{rootMargin:"200px"}),this.$nextTick(()=>{this.$refs.sentinel&&this.observer.observe(this.$refs.sentinel)})},fetchClaims(){return y(this,null,function*(){this.start>0&&(this.loadingMore=!0),yield this.claimsResource.submit({status:this.activeTab,start:this.start,limit:u});const t=this.claimsResource.data||[];this.start===0?this.claims=t:this.claims.push(...t),this.hasMore=t.length===u,this.loadingMore=!1,this.$nextTick(()=>{this.$refs.sentinel&&this.observer&&this.observer.observe(this.$refs.sentinel)})})},loadMore(){this.start+=u,this.fetchClaims()}}},L={class:"px-4 py-5"},V={class:"flex gap-2 mb-5 overflow-x-auto no-scrollbar"},A=["onClick"],B={key:0,class:"ml-1.5 text-xs opacity-70"},O={key:0,class:"space-y-3"},j={key:1,class:"space-y-3"},D={ref:"sentinel",class:"h-1"},G={key:0,class:"flex justify-center py-3"},P={key:1,class:"text-center text-xs text-gray-400 py-3"},Z={class:"btn-primary h-8 px-3 text-sm font-medium rounded-lg text-white inline-flex items-center gap-1.5"};function z(l,t,o,v,e,m){const b=h("ClaimCard"),n=h("FeatherIcon"),r=h("router-link"),c=h("EmptyState");return s(),i("div",L,[d("div",V,[(s(!0),i(f,null,p(e.tabs,a=>(s(),i("button",{key:a.value,onClick:U=>e.activeTab=a.value,class:N(["shrink-0 px-4 py-2 rounded-xl text-sm font-medium transition-all duration-150",e.activeTab===a.value?"bg-gray-900 text-white":"bg-white text-gray-600 border border-gray-100 hover:bg-gray-50"])},[_(x(a.label)+" ",1),a.count!==void 0?(s(),i("span",B,x(a.count),1)):g("",!0)],10,A))),128))]),v.claimsResource.loading&&!e.claims.length?(s(),i("div",O,[(s(),i(f,null,p(5,a=>d("div",{key:a,class:"bg-white rounded-2xl p-4 border border-gray-100 animate-pulse"},[...t[0]||(t[0]=[S('<div class="flex items-center gap-3" data-v-10b56f4c><div class="w-10 h-10 rounded-xl bg-gray-100" data-v-10b56f4c></div><div class="flex-1" data-v-10b56f4c><div class="h-4 bg-gray-100 rounded w-24 mb-2" data-v-10b56f4c></div><div class="h-3 bg-gray-50 rounded w-32" data-v-10b56f4c></div></div><div class="h-5 bg-gray-100 rounded w-20" data-v-10b56f4c></div></div>',1)])])),64))])):e.claims.length?(s(),i("div",j,[(s(!0),i(f,null,p(e.claims,a=>(s(),C(b,{key:a.name,claim:a},null,8,["claim"]))),128)),d("div",D,null,512),e.loadingMore?(s(),i("div",G,[...t[1]||(t[1]=[d("div",{class:"w-6 h-6 border-2 border-gray-200 border-t-gray-600 rounded-full animate-spin"},null,-1)])])):g("",!0),!e.hasMore&&e.claims.length>e.PAGE_SIZE?(s(),i("p",P," All claims loaded ")):g("",!0)])):(s(),C(c,{key:2,icon:"file-text",title:m.emptyTitle,message:m.emptyMessage},{action:k(()=>[w(r,{to:"/new",class:"mt-4"},{default:k(()=>[d("button",Z,[w(n,{name:"plus",class:"w-4 h-4"}),t[2]||(t[2]=_(" New Claim ",-1))])]),_:1})]),_:1},8,["title","message"]))])}const J=E(F,[["render",z],["__scopeId","data-v-10b56f4c"]]);export{J as default};
